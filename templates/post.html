{% extends "base.html" %}
{% block title %}{{ post.title }} - This Is A Blog{% endblock %}
{% block content %}
<main id="main" class="article" tabindex="-1">
<article>
<div class="post-intro">
<p class="date">{{ post.date|format_date }}</p>
<p class="category">
<a href="/category-{{ post.category|slugify }}/">{{ post.category }}</a>
</p>
<h1>{{ post.title }}</h1>
{% if post.subtitle %}
<h2>{{ post.subtitle }}</h2>
{% endif %}
</div>
<div class="font-toggle" role="group" aria-label="Font style toggle">
<button class="toggle-option active" data-font="sans-serif" aria-pressed="true">
<span class="sans">T</span>
</button>
<button class="toggle-option" data-font="serif" aria-pressed="false">
<span class="serif">T</span>
</button>
</div>
<div class="post-content">
{{ post.content|safe }}
</div>
<hr>
<p class="feed-link">
	<span>P.S. I’m lazy, you won’t get flooded:</span>
	<a href="/feed.xml"> Subscribe to my feed.</a>
</p>
<nav class="post-navigation" aria-label="Post navigation">
{% if prev_post -%}
	<a class="prev" href="{{ prev_post.url }}" rel="prev" aria-label="Previous post: {{ prev_post.title }}"><svg class="arrow" aria-hidden="true" viewBox="0 0 40 40" fill="currentColor"><path d="M40 37.07 3.1.16.16 3.09 37.06 40z"/><path d="M4.15 0H0v31.14h4.15z"/><path d="M31.13 0H0v4.15h31.13z"/></svg>{{ prev_post.title }}</a>
{% endif -%}
{% if next_post -%}
	<a class="next" href="{{ next_post.url }}" rel="next" aria-label="Next post: {{ next_post.title }}">{{ next_post.title }}<svg class="arrow" aria-hidden="true" viewBox="0 0 40 40" fill="currentColor"><path d="M0 37.07 36.9.16l2.94 2.93L2.94 40z"/><path d="M35.85 0H40v31.14h-4.15z"/><path d="M8.87 0H40v4.15H8.87z"/></svg></a>
{% endif -%}
</nav>
</article>
</main>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const toggleButtons = document.querySelectorAll('.toggle-option');
    const postContent = document.querySelector('.post-content');
    const feedLink = document.querySelector('.feed-link');
    
    // Check for saved preference
    const savedFont = localStorage.getItem('preferredFont');
    if (savedFont === 'serif') {
        postContent.classList.add('serif-mode');
        feedLink.classList.add('serif-mode');
        toggleButtons.forEach(btn => {
            if (btn.dataset.font === 'serif') {
                btn.classList.add('active');
                btn.setAttribute('aria-pressed', 'true');
            } else {
                btn.classList.remove('active');
                btn.setAttribute('aria-pressed', 'false');
            }
        });
    }
    
    toggleButtons.forEach(button => {
        button.addEventListener('click', function() {
            const selectedFont = this.dataset.font;
            
            // Update active states
            toggleButtons.forEach(btn => {
                btn.classList.remove('active');
                btn.setAttribute('aria-pressed', 'false');
            });
            this.classList.add('active');
            this.setAttribute('aria-pressed', 'true');
            
            // Apply font change
            if (selectedFont === 'serif') {
                postContent.classList.add('serif-mode');
                feedLink.classList.add('serif-mode');
                localStorage.setItem('preferredFont', 'serif');
            } else {
                postContent.classList.remove('serif-mode');
                feedLink.classList.remove('serif-mode');
                localStorage.setItem('preferredFont', 'sans-serif');
            }
        });
    });
});
</script>
{% endblock %}